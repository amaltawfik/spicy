% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cross_tab.R
\name{cross_tab}
\alias{cross_tab}
\alias{ctab}
\alias{ct}
\title{Cross-tabulation with Percentages, Weights, and Grouping}
\usage{
cross_tab(
  d = parent.frame(),
  x,
  y = NULL,
  by = NULL,
  weights = NULL,
  rescale_weights = FALSE,
  digits = 1,
  rowprct = FALSE,
  row_total = TRUE,
  column_total = TRUE,
  n = TRUE,
  drop = TRUE,
  include_stats = TRUE,
  combine = FALSE,
  file = NULL,
  ...
)
}
\arguments{
\item{d}{A \code{data.frame}. Must contain all the variables referenced in \code{x}, \code{y}, \code{by}, and \code{weights}.}

\item{x}{The variable to tabulate (row). Must be a column of \code{d}.}

\item{y}{The variable to tabulate against (column). Must be a column of \code{d}. If \code{NULL}, computes a one-way frequency table.}

\item{by}{Optional: a grouping variable or interaction of variables (e.g. \code{interaction(v1, v2)}). Will be coerced to character. Must refer to columns of \code{d}.}

\item{weights}{Optional numeric vector of weights. Must be a column of \code{d}.}

\item{rescale_weights}{Logical. If \code{TRUE}, rescale weights so that the total weighted count equals the unweighted count.}

\item{digits}{Integer. Number of decimal places to display for percentages. Default is \code{1}.}

\item{rowprct}{Logical. If \code{TRUE}, compute percentages by row. Otherwise, percentages are computed by column (default).}

\item{row_total}{Logical. If \code{TRUE} (default), adds a row total column.}

\item{column_total}{Logical. If \code{TRUE} (default), adds a column total row.}

\item{n}{Logical. If \code{TRUE} (default), includes effective counts (\code{N}) as a row or column.}

\item{drop}{Logical. If \code{TRUE} (default), drops empty rows and columns from the table.}

\item{include_stats}{Logical. If \code{TRUE} (default), computes Chi-squared test and Cramer's V when applicable.}

\item{combine}{Logical. If \code{TRUE}, combines all group-level tables into a single tibble with a \code{by} column. Otherwise, returns a list.}

\item{file}{Reserved for future use (e.g., exporting).}

\item{...}{Further arguments (currently unused).}
}
\value{
A tibble of class \code{spicy}, or a list of such tibbles (if \code{by} is used and \code{combine = FALSE}).
}
\description{
\code{cross_tab} produces a cross-tabulation table of \code{x} by \code{y}, with optional grouping by a third variable (\code{by}). Supports weighted frequencies, row or column percentages, row/column totals, effective counts, and chi-squared statistics.
}
\details{
All variables (\code{x}, \code{y}, \code{by}, \code{weights}) must be columns of the data frame \code{d}. The function supports grouped output (\code{by}), and optionally combines all tables into a single tibble if \code{combine = TRUE}.
}
\examples{
data(mtcars)
mtcars$gear <- factor(mtcars$gear)
mtcars$cyl <- factor(mtcars$cyl)
mtcars$vs <- factor(mtcars$vs, labels = c("V", "S"))
mtcars$am <- factor(mtcars$am, labels = c("auto", "manual"))

# Basic usage
cross_tab(mtcars, cyl, gear)

# Row percentages
cross_tab(mtcars, cyl, gear, rowprct = TRUE)

# With weights
cross_tab(mtcars, cyl, gear, weights = mpg)

# With weight rescaling
cross_tab(mtcars, cyl, gear, weights = mpg, rescale_weights = TRUE)

# Grouped by a variable
cross_tab(mtcars, cyl, gear, by = am)

# Grouped by interaction of variables
cross_tab(mtcars, cyl, gear, by = interaction(am, vs), combine = TRUE)

# Combined output
cross_tab(mtcars, cyl, gear, by = am, combine = TRUE)

# Pipe-friendly
mtcars |> cross_tab(cyl, gear, by = am)

# Without totals or stats
cross_tab(mtcars, cyl, gear, row_total = FALSE, column_total = FALSE, n = FALSE,
include_stats = FALSE)

# Univariate usage (x only)
cross_tab(mtcars, x = cyl)

}
